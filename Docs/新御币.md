
## 新御币


### 自行实现无限弹药，使其不再需要附魔无限

现在的御币是一个类似弓的发射器，对于弓，无论蓄力多久，在蓄力结束之后都是会发射的。
原先的御币为了实现无弹药射击，把自身作为弹药，配合自带的无限附魔，实现仅消耗耐久就能射击效果。

现计划移除这个自带的无限附魔，因为它和经验修补是冲突的，并且为了实现更丰富的射击类型，发射这个动作也不再由MC自动执行，而是由脚本实现。

经过一些实验之后，一个新方案出现了：只需要改变射击组件，让它变成需要蓄力足够时间才能上弹的，和弩一样的发射器，然后把上弹时间设为非常大的一个值，就可以通过监听蓄力开始事件和蓄力中止事件来实现一种  按下右键能够持续发射的发射器

### 停止检测

需要注意的是，因为物品的使用时间被设的很长，所以如果在蓄力过程中切换到其它物品，并不会触 release 脚本事件，只会触发 stop 事件，需要监听 stopUseEvent 而不是 release

此外，可能还需要在每次发射前都检测玩家手上是否还是这个物品，如果不是，则终止循环的监听，双重保险。

### > 损耗计算

如果每一轮射击就损耗一次，御币会不断播放动画，不太美观。

1、在多次射击后、使用结束时以及耐久即将耗尽时，才会进行损耗判定，一次损耗可能会消耗超过1点耐久
2、采用与玩家绑定的累计制。损耗进度通过动态属性与玩家绑定，如果玩家在射击时直接切到其它物品导致损耗没能立即生效，则会在下次射击开始时进行损耗。

### 优化符札

TODO: 当前进度：加一个有朝向的符札弹种
- 角度变化不够平滑。需要想办法加入中间帧，可以分离运动方向角度和实际角度，每次计算时，让实际角度往运动方向角度靠拢
- 过轴旋转有问题，会转180度，实际上不需要转，这个也可以通过上面的实际角度思想解决

发射时初始化朝向，为其专门制作一个控制类
通过接口改变速度方向时，自动改变朝向
一次蓄力发射多轮弹幕，立即进行一次损耗判定，不再是一次蓄力发射一轮，发射多次后才进行一次损耗判定

### 区分不同的射击模式 & 模式切换

说到区分模式，有 lore 和 动态属性两种方案，考虑到模式切换是相通的，并且丢失的代价不大，所以使用动态属性来区分不同的射击模式

- 不同弹种有不同的效果：
  - 符札：伤害固定且偏小，蓄力时连发，射速较快
  - 心弹：发出两个运行时会绕中轴线旋转的心弹，伤害较大且有穿透效果，蓄力结束后发射，蓄力时间越久伤害越高
  - 

### 附魔效果

多重射击（multishot）：平行发射三排弹幕
穿透（piercing）：弹幕在击中目标后可以继续前进击中下一个目标
快速装填（quick_charge）：减少蓄力时间，每级减少【弩基础装填1.25秒（25刻），每级减0.25秒（5刻），正常状态最低0.5s】
- 0：
-

### 符卡

使用御币攻击可以累积 cost，cost足够则可以释放符卡，符卡随机生成，可以事先构筑卡组，和则的机制相似。
释放符卡会消耗符卡上限，每隔一段时间可恢复一张符卡上上限


*搞个新符 向四周发射大量速度不一的符札，这些符札的速度会不断增大，并且会转弯，直到朝着玩家发射时视线的方向
*再来一个爆炸符就爽翻了